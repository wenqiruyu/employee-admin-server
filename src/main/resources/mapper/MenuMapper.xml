<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.employee.admin.mapper.IMenuMapper">
    <resultMap id="menuResultMap" type="com.employee.admin.vo.MenuVO">
        <result column="icon" jdbcType="BIGINT" property="icon"/>
        <result column="index" jdbcType="VARCHAR" property="index"/>
        <result column="title" jdbcType="VARCHAR" property="title"/>

        <collection property="subMenuList" resultMap="menuSubResultMap" />
    </resultMap>

    <resultMap id="menuSubResultMap" type="com.employee.admin.vo.MenuSubVO">
        <result column="icon" jdbcType="BIGINT" property="icon"/>
        <result column="index" jdbcType="VARCHAR" property="index"/>
        <result column="title" jdbcType="VARCHAR" property="title"/>
    </resultMap>

    <select id="getAllMenu" resultMap="menuResultMap">
        select par.icon,par.index,par.title,sub.icon,sub.index,sub.title
        from (
            select *
            from employee_menu_t
            where delete_flag = 0
            and is_sub = 1) sub,(
            select *
            from employee_menu_t
            where delete_flag = 0
            and is_sub = 0) par
        where par.id = sub.parent_id
    </select>
</mapper>